import os

from dotenv import load_dotenv
from google import genai
from google.genai import types
from collections import deque
import time

load_dotenv()

titles = [
    "성수동 누수탐지 성동구 아파트 누수공사 전문 설비 업체",
"성수동하수구막힘 싱크대막힘 독보적 하수도뚫는곳 업체 마리오설비",
"누수되는 노후된 배관 교체 작업으로 누수를 해결한 사례_옥수동",
"가스온수기 설비 공사! 성수동 건물 배관 이설 작업 시공사례",
"성동구 배관설비 옥수동 하수배관 마감 시공 - 성수동 배관 수리 보수 전문 응봉동 출장 설비업체",
"성수동 습식 주방 설비 공사 설비 업체",
"성동구 씽크대막힘 성수동 옥수동 싱크대 뚫음 자주 막히는 배수구 뚫음 전문 설비 업체",
"성동구 변기교체 홍익동 성수동 화장실 투피스 양변기 수리 설치 설비업체",
"구의동 누수탐지 성수동 빌라주택에서 발생한 보일러 온수배관누수문제 설비공사해결전문업체",
"성수동 전기온수기 설치 사무실 싱크대 및 온수기 설비"]

address = "성수동"
company = "설비업체"
place = "신공간 설비업체"
title_list = deque(maxlen=20)

ai_detail = """<들어가야 하는 내용>

|종합보수설비
[전문건설업 난방시공업 제1종 면허보유]
[도시가스 3종면허보유]
[에너지관리기능사 국가기술자격증보유]
1.수도누수탐지, 수도누수공사, 난방배관교체공사
2.결로방지공사, 홈통 및 우수배관공사
3.베란다(발코니)확장공사
4.보일러 및 온수기,전기온돌판넬 시공
5.겨울철 수도해빙(언수도녹임) 및 동파수리

|화장실 및 주방설비
1.하수도배관,수도배관,타일시공,욕조시공
2.세면대교체,양변기교체,샤워기교체
3.씽크대수도꼭지, 세면대수도꼭지, 세탁기수도꼭지 등 수전교체
4.화장실 수건장 및 거울 등 악세사리 시공
5.수도배관 위치 변경 및 하수구배관 위치  변경 공사 
6.화장실리모델링 ,주방 리모델링 공사

<들어가면 안 되는 내용>

1. 냉난방설비 설치 및 수리 각종 설비점검 및 유지보수는 안함. 이건 에어컨설비 임
2. 겨울철 난방 문제나 여름철 에어컨 고장으로 불편을 겪고 계신가요?저희는 냉난방 설비의 설치, 수리, 점검을 전문적으로 진행합니다.: 이건 에어컨설비 임
3. 공장 설비와 같은 산업용 설비의 관리 및 유지보수도 전문적으로 수행하고 있습니다. 생산성 향상과 안전을 위해 설비의 정기적인 점검과 관리가 필수적입니다. 저희는 다양한 산업 설비에 대한 깊이 있는 이해를 바탕으로 효율적인 관리 방안을 제시하고, 최적의 상태를 유지할 수 있도록 돕겠습니다.: 산업용설비아님 공장설비도 안함"""

ai_common = """<반드시 들어가면 안되는 내용>
1. 24시 긴급출동! 24시 대기!: 등등 24시 안함
2. 하수구 또는 양변기 막힘/뚫음 해결전문가: 양변기,하수구 막힌거 뚫는 건 하수구업자가함
3. 정확한 비용 산정 시스템을 운영하고 있습니다. 추가 비용 발생 없이, 미리 약속드린 금액으로 모든 작업을 완료합니다.: 미리 언급할 필요 없음, 간혹 공사를 하다보면 추가 되는 경우도 있긴 있음
4. 하자보증을 해준다거나, 하자보증보험을 가입해 준다거나, 하자를 몇 년간 봐준다거나,   하자에 대해 끝까지 책임 진다는 등의 하자관련 언급하면 안 됨
5. 24시간 연중무휴로 고객센터 운영하고 있음: 24시 안함
6. 제목이 됐든 내용이 됐든 10년 누수걱정 끝. 과 같은 내용을 기재해 10년간 하자보증해 주는 것으로 혼동되게 하는 멘트는 안해야 함
7. 출장비없이, 무료로, 무료상담받으세요.등등 출장비없다는 말과 무료상담받으라는 멘트금지
8. 씽크대수리는 씽크대업자가 함 우리가 안함
"""

client = genai.Client(api_key=os.getenv("API_KEY"))
model = "gemini-2.0-flash"

import os

from dotenv import load_dotenv
from google import genai
from google.genai import types
from collections import deque
import time

load_dotenv()

titles = [
    "성수동 누수탐지 성동구 아파트 누수공사 전문 설비 업체",
"성수동하수구막힘 싱크대막힘 독보적 하수도뚫는곳 업체 마리오설비",
"누수되는 노후된 배관 교체 작업으로 누수를 해결한 사례_옥수동",
"가스온수기 설비 공사! 성수동 건물 배관 이설 작업 시공사례",
"성동구 배관설비 옥수동 하수배관 마감 시공 - 성수동 배관 수리 보수 전문 응봉동 출장 설비업체",
"성수동 습식 주방 설비 공사 설비 업체",
"성동구 씽크대막힘 성수동 옥수동 싱크대 뚫음 자주 막히는 배수구 뚫음 전문 설비 업체",
"성동구 변기교체 홍익동 성수동 화장실 투피스 양변기 수리 설치 설비업체",
"구의동 누수탐지 성수동 빌라주택에서 발생한 보일러 온수배관누수문제 설비공사해결전문업체",
"성수동 전기온수기 설치 사무실 싱크대 및 온수기 설비"]

address = "성수동"
company = "설비업체"
place = "신공간 설비업체"
title_list = deque(maxlen=20)

ai_detail = """<들어가야 하는 내용>

|종합보수설비
[전문건설업 난방시공업 제1종 면허보유]
[도시가스 3종면허보유]
[에너지관리기능사 국가기술자격증보유]
1.수도누수탐지, 수도누수공사, 난방배관교체공사
2.결로방지공사, 홈통 및 우수배관공사
3.베란다(발코니)확장공사
4.보일러 및 온수기,전기온돌판넬 시공
5.겨울철 수도해빙(언수도녹임) 및 동파수리

|화장실 및 주방설비
1.하수도배관,수도배관,타일시공,욕조시공
2.세면대교체,양변기교체,샤워기교체
3.씽크대수도꼭지, 세면대수도꼭지, 세탁기수도꼭지 등 수전교체
4.화장실 수건장 및 거울 등 악세사리 시공
5.수도배관 위치 변경 및 하수구배관 위치  변경 공사 
6.화장실리모델링 ,주방 리모델링 공사

<들어가면 안 되는 내용>

1. 냉난방설비 설치 및 수리 각종 설비점검 및 유지보수는 안함. 이건 에어컨설비 임
2. 겨울철 난방 문제나 여름철 에어컨 고장으로 불편을 겪고 계신가요?저희는 냉난방 설비의 설치, 수리, 점검을 전문적으로 진행합니다.: 이건 에어컨설비 임
3. 공장 설비와 같은 산업용 설비의 관리 및 유지보수도 전문적으로 수행하고 있습니다. 생산성 향상과 안전을 위해 설비의 정기적인 점검과 관리가 필수적입니다. 저희는 다양한 산업 설비에 대한 깊이 있는 이해를 바탕으로 효율적인 관리 방안을 제시하고, 최적의 상태를 유지할 수 있도록 돕겠습니다.: 산업용설비아님 공장설비도 안함"""

ai_common = """<반드시 들어가면 안되는 내용>
1. 24시 긴급출동! 24시 대기!: 등등 24시 안함
2. 하수구 또는 양변기 막힘/뚫음 해결전문가: 양변기,하수구 막힌거 뚫는 건 하수구업자가함
3. 정확한 비용 산정 시스템을 운영하고 있습니다. 추가 비용 발생 없이, 미리 약속드린 금액으로 모든 작업을 완료합니다.: 미리 언급할 필요 없음, 간혹 공사를 하다보면 추가 되는 경우도 있긴 있음
4. 하자보증을 해준다거나, 하자보증보험을 가입해 준다거나, 하자를 몇 년간 봐준다거나,   하자에 대해 끝까지 책임 진다는 등의 하자관련 언급하면 안 됨
5. 24시간 연중무휴로 고객센터 운영하고 있음: 24시 안함
6. 제목이 됐든 내용이 됐든 10년 누수걱정 끝. 과 같은 내용을 기재해 10년간 하자보증해 주는 것으로 혼동되게 하는 멘트는 안해야 함
7. 출장비없이, 무료로, 무료상담받으세요.등등 출장비없다는 말과 무료상담받으라는 멘트금지
8. 씽크대수리는 씽크대업자가 함 우리가 안함
"""

client = genai.Client(api_key=os.getenv("API_KEY"))

def generate_prompt_summary():
    prompt = f"""
    나는 {address} 지역에서 {place}라는 {company}를 운영하고 있어.
    안전하게 제목을 만들기 위해 아래 사항을 요약해줘:
    1) 넣어야 하는 내용
    2) 절대 넣으면 안 되는 내용

    넣어야 하는 내용:
    {ai_detail}

    넣으면 안 되는 내용:
    {ai_common}

    기존 상위 노출 제목:
    {', '.join(titles)}

    기존 생성 제목 리스트:
    {list(title_list)}
    """

    response = client.models.generate_content(
        model=model,
        contents=prompt,
        config=types.GenerateContentConfig(temperature=0.5)
    )
    return response.text  # 요약/조건 정리

def generate_title(condition_summary):
    prompt = f"""
    아래 조건을 지켜서 홍보 글 제목을 한 줄 만들어줘.
    조건 요약:
    {condition_summary}

    기존 상위 노출 제목:
    {', '.join(titles)}

    주소: {address}
    업종: {company}
    회사명: {place}

    요구사항:
    - 제목 글자수 25~40자
    - 문장형/긴급형/정보형/후기형 스타일 섞기
    - 기존 제목과 구조/단어 겹치지 않게
    - 반드시 회사명 {place} 포함
    """

    response = client.models.generate_content(
        model=model,
        contents=prompt,
        config=types.GenerateContentConfig(temperature=0.8)
    )
    return response.text

def asdf():
    prompt = f"""
    소갈비찜 레시피 알려줘
    """

    response = client.models.generate_content(
        model=model,
        contents=prompt,
        config=types.GenerateContentConfig(temperature=0.8)
    )
    return response.text

# summary = generate_prompt_summary()
# response = generate_title(summary)
response = asdf()
print(response)
